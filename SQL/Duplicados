--Cantidad de duplicados

-- Contar valores duplicados en la columna 'product_id'
SELECT 
    'product_id' AS column_name, 
    COUNT(*) AS duplicate_count 
FROM (
    SELECT 
        product_id 
    FROM 
        `proyecto6-etl.Data_Set.superstore`
    GROUP BY 
        product_id 
    HAVING 
        COUNT(*) > 1
) AS duplicates

UNION ALL

-- Contar valores duplicados en la columna 'order_id'
SELECT 
    'order_id' AS column_name, 
    COUNT(*) AS duplicate_count 
FROM (
    SELECT 
        order_id 
    FROM 
        `proyecto6-etl.Data_Set.superstore`
    GROUP BY 
        order_id 
    HAVING 
        COUNT(*) > 1
) AS duplicates

UNION ALL

-- Contar valores duplicados en la columna 'customer_ID'
SELECT 
    'customer_ID' AS column_name, 
    COUNT(*) AS duplicate_count 
FROM (
    SELECT 
        customer_ID 
    FROM 
        `proyecto6-etl.Data_Set.superstore`
    GROUP BY 
        customer_ID 
    HAVING 
        COUNT(*) > 1
) AS duplicates

UNION ALL

-- Contar valores duplicados en la columna 'row_id'
SELECT 
    'row_id' AS column_name, 
    COUNT(*) AS duplicate_count 
FROM (
    SELECT 
        row_id 
    FROM 
        `proyecto6-etl.Data_Set.superstore`
    GROUP BY 
        row_id 
    HAVING 
        COUNT(*) > 1
) AS duplicates

UNION ALL

-- Contar valores duplicados en la columna 'product_name'
SELECT 
    'product_name' AS column_name, 
    COUNT(*) AS duplicate_count 
FROM (
    SELECT 
        product_name 
    FROM 
        `proyecto6-etl.Data_Set.superstore`
    GROUP BY 
        product_name 
    HAVING 
        COUNT(*) > 1
) AS duplicates

UNION ALL

-- Contar valores duplicados en la columna 'category'
SELECT 
    'category' AS column_name, 
    COUNT(*) AS duplicate_count 
FROM (
    SELECT 
        category 
    FROM 
        `proyecto6-etl.Data_Set.superstore`
    GROUP BY 
        category 
    HAVING 
        COUNT(*) > 1
) AS duplicates

UNION ALL

-- Contar valores duplicados en la columna 'city'
SELECT 
    'city' AS column_name, 
    COUNT(*) AS duplicate_count 
FROM (
    SELECT 
        city 
    FROM 
        `proyecto6-etl.Data_Set.superstore`
    GROUP BY 
        city 
    HAVING 
        COUNT(*) > 1
) AS duplicates

UNION ALL

-- Contar valores duplicados en la columna 'country'
SELECT 
    'country' AS column_name, 
    COUNT(*) AS duplicate_count 
FROM (
    SELECT 
        country 
    FROM 
        `proyecto6-etl.Data_Set.superstore`
    GROUP BY 
        country 
    HAVING 
        COUNT(*) > 1
) AS duplicates

UNION ALL

-- Contar valores duplicados en la columna 'discount'
SELECT 
    'discount' AS column_name, 
    COUNT(*) AS duplicate_count 
FROM (
    SELECT 
        discount 
    FROM 
        `proyecto6-etl.Data_Set.superstore`
    GROUP BY 
        discount 
    HAVING 
        COUNT(*) > 1
) AS duplicates

UNION ALL

-- Contar valores duplicados en la columna 'market'
SELECT 
    'market' AS column_name, 
    COUNT(*) AS duplicate_count 
FROM (
    SELECT 
        market 
    FROM 
        `proyecto6-etl.Data_Set.superstore`
    GROUP BY 
        market 
    HAVING 
        COUNT(*) > 1
) AS duplicates

UNION ALL

-- Contar valores duplicados en la columna 'unknown'
SELECT 
    'unknown' AS column_name, 
    COUNT(*) AS duplicate_count 
FROM (
    SELECT 
        unknown 
    FROM 
        `proyecto6-etl.Data_Set.superstore`
    GROUP BY 
        unknown 
    HAVING 
        COUNT(*) > 1
) AS duplicates

UNION ALL

-- Contar valores duplicados en la columna 'order_date'
SELECT 
    'order_date' AS column_name, 
    COUNT(*) AS duplicate_count 
FROM (
    SELECT 
        order_date 
    FROM 
        `proyecto6-etl.Data_Set.superstore`
    GROUP BY 
        order_date 
    HAVING 
        COUNT(*) > 1
) AS duplicates

UNION ALL

-- Contar valores duplicados en la columna 'order_priority'
SELECT 
    'order_priority' AS column_name, 
    COUNT(*) AS duplicate_count 
FROM (
    SELECT 
        order_priority 
    FROM 
        `proyecto6-etl.Data_Set.superstore`
    GROUP BY 
        order_priority 
    HAVING 
        COUNT(*) > 1
) AS duplicates

UNION ALL

-- Contar valores duplicados en la columna 'profit'
SELECT 
    'profit' AS column_name, 
    COUNT(*) AS duplicate_count 
FROM (
    SELECT 
        profit 
    FROM 
        `proyecto6-etl.Data_Set.superstore`
    GROUP BY 
        profit 
    HAVING 
        COUNT(*) > 1
) AS duplicates

UNION ALL

-- Contar valores duplicados en la columna 'quantity'
SELECT 
    'quantity' AS column_name, 
    COUNT(*) AS duplicate_count 
FROM (
    SELECT 
        quantity 
    FROM 
        `proyecto6-etl.Data_Set.superstore`
    GROUP BY 
        quantity 
    HAVING 
        COUNT(*) > 1
) AS duplicates

UNION ALL

-- Contar valores duplicados en la columna 'region'
SELECT 
    'region' AS column_name, 
    COUNT(*) AS duplicate_count 
FROM (
    SELECT 
        region 
    FROM 
        `proyecto6-etl.Data_Set.superstore`
    GROUP BY 
        region 
    HAVING 
        COUNT(*) > 1
) AS duplicates

UNION ALL

-- Contar valores duplicados en la columna 'sales'
SELECT 
    'sales' AS column_name, 
    COUNT(*) AS duplicate_count 
FROM (
    SELECT 
        sales 
    FROM 
        `proyecto6-etl.Data_Set.superstore`
    GROUP BY 
        sales 
    HAVING 
        COUNT(*) > 1
) AS duplicates

UNION ALL

-- Contar valores duplicados en la columna 'segment'
SELECT 
    'segment' AS column_name, 
    COUNT(*) AS duplicate_count 
FROM (
    SELECT 
        segment 
    FROM 
        `proyecto6-etl.Data_Set.superstore`
    GROUP BY 
        segment 
    HAVING 
        COUNT(*) > 1
) AS duplicates

UNION ALL

-- Contar valores duplicados en la columna 'ship_date'
SELECT 
    'ship_date' AS column_name, 
    COUNT(*) AS duplicate_count 
FROM (
    SELECT 
        ship_date 
    FROM 
        `proyecto6-etl.Data_Set.superstore`
    GROUP BY 
        ship_date 
    HAVING 
        COUNT(*) > 1
) AS duplicates

UNION ALL

-- Contar valores duplicados en la columna 'ship_mode'
SELECT 
    'ship_mode' AS column_name, 
    COUNT(*) AS duplicate_count 
FROM (
    SELECT 
        ship_mode 
    FROM 
        `proyecto6-etl.Data_Set.superstore`
    GROUP BY 
        ship_mode 
    HAVING 
        COUNT(*) > 1
) AS duplicates

UNION ALL

-- Contar valores duplicados en la columna 'shipping_cost'
SELECT 
    'shipping_cost' AS column_name, 
    COUNT(*) AS duplicate_count 
FROM (
    SELECT 
        shipping_cost 
    FROM 
        `proyecto6-etl.Data_Set.superstore`
    GROUP BY 
        shipping_cost 
    HAVING 
        COUNT(*) > 1
) AS duplicates

UNION ALL

-- Contar valores duplicados en la columna 'state'
SELECT 
    'state' AS column_name, 
    COUNT(*) AS duplicate_count 
FROM (
    SELECT 
        state 
    FROM 
        `proyecto6-etl.Data_Set.superstore`
    GROUP BY 
        state 
    HAVING 
        COUNT(*) > 1
) AS duplicates

UNION ALL

-- Contar valores duplicados en la columna 'sub_category'
SELECT 
    'sub_category' AS column_name, 
    COUNT(*) AS duplicate_count 
FROM (
    SELECT 
        sub_category 
    FROM 
        `proyecto6-etl.Data_Set.superstore`
    GROUP BY 
        sub_category 
    HAVING 
        COUNT(*) > 1
) AS duplicates

UNION ALL

-- Contar valores duplicados en la columna 'year'
SELECT 
    'year' AS column_name, 
    COUNT(*) AS duplicate_count 
FROM (
    SELECT 
        year 
    FROM 
        `proyecto6-etl.Data_Set.superstore`
    GROUP BY 
        year 
    HAVING 
        COUNT(*) > 1
) AS duplicates

UNION ALL

-- Contar valores duplicados en la columna 'market2'
SELECT 
    'market2' AS column_name, 
    COUNT(*) AS duplicate_count 
FROM (
    SELECT 
        market2 
    FROM 
        `proyecto6-etl.Data_Set.superstore`
    GROUP BY 
        market2 
    HAVING 
 COUNT(*) > 1
) AS duplicates;


-- Contar duplicados y sus ocurrencias en mÃºltiples columnas 

SELECT 'category' AS column_name, CAST(category AS STRING) AS value, COUNT(*) AS occurrence_count
FROM `proyecto6-etl.Data_Set.superstore`
GROUP BY category
HAVING COUNT(*) > 1

UNION ALL

SELECT 'city' AS column_name, CAST(city AS STRING) AS value, COUNT(*) AS occurrence_count
FROM `proyecto6-etl.Data_Set.superstore`
GROUP BY city
HAVING COUNT(*) > 1

UNION ALL

SELECT 'country' AS column_name, CAST(country AS STRING) AS value, COUNT(*) AS occurrence_count
FROM `proyecto6-etl.Data_Set.superstore`
GROUP BY country
HAVING COUNT(*) > 1

UNION ALL

SELECT 'customer_id' AS column_name, CAST(customer_id AS STRING) AS value, COUNT(*) AS occurrence_count
FROM `proyecto6-etl.Data_Set.superstore`
GROUP BY customer_id
HAVING COUNT(*) > 1

UNION ALL

SELECT 'customer_name' AS column_name, CAST(customer_name AS STRING) AS value, COUNT(*) AS occurrence_count
FROM `proyecto6-etl.Data_Set.superstore`
GROUP BY customer_name
HAVING COUNT(*) > 1

UNION ALL

SELECT 'order_id' AS column_name, CAST(order_id AS STRING) AS value, COUNT(*) AS occurrence_count
FROM `proyecto6-etl.Data_Set.superstore`
GROUP BY order_id
HAVING COUNT(*) > 1

UNION ALL

SELECT 'product_id' AS column_name, CAST(product_id AS STRING) AS value, COUNT(*) AS occurrence_count
FROM `proyecto6-etl.Data_Set.superstore`
GROUP BY product_id
HAVING COUNT(*) > 1

UNION ALL

SELECT 'product_name' AS column_name, CAST(product_name AS STRING) AS value, COUNT(*) AS occurrence_count
FROM `proyecto6-etl.Data_Set.superstore`
GROUP BY product_name
HAVING COUNT(*) > 1

UNION ALL

SELECT 'row_id' AS column_name, CAST(row_id AS STRING) AS value, COUNT(*) AS occurrence_count
FROM `proyecto6-etl.Data_Set.superstore`
GROUP BY row_id
HAVING COUNT(*) > 1

UNION ALL

SELECT 'segment' AS column_name, CAST(segment AS STRING) AS value, COUNT(*) AS occurrence_count
FROM `proyecto6-etl.Data_Set.superstore`
GROUP BY segment
HAVING COUNT(*) > 1

UNION ALL

SELECT 'ship_mode' AS column_name, CAST(ship_mode AS STRING) AS value, COUNT(*) AS occurrence_count
FROM `proyecto6-etl.Data_Set.superstore`
GROUP BY ship_mode
HAVING COUNT(*) > 1

UNION ALL

SELECT 'state' AS column_name, CAST(state AS STRING) AS value, COUNT(*) AS occurrence_count
FROM `proyecto6-etl.Data_Set.superstore`
GROUP BY state
HAVING COUNT(*) > 1

UNION ALL

SELECT 'sub_category' AS column_name, CAST(sub_category AS STRING) AS value, COUNT(*) AS occurrence_count
FROM `proyecto6-etl.Data_Set.superstore`
GROUP BY sub_category
HAVING COUNT(*) > 1

UNION ALL

SELECT 'year' AS column_name, CAST(year AS STRING) AS value, COUNT(*) AS occurrence_count
FROM `proyecto6-etl.Data_Set.superstore`
GROUP BY year
HAVING COUNT(*) > 1

UNION ALL

SELECT 'market2' AS column_name, CAST(market2 AS STRING) AS value, COUNT(*) AS occurrence_count
FROM `proyecto6-etl.Data_Set.superstore`
GROUP BY market2
HAVING COUNT(*) > 1

ORDER BY column_name, occurrence_count DESC;
